<!DOCTYPE html>
<html>
  <head>
    <title>apiDoc (COMEM+ Web Dev)</title>
    <meta charset='utf-8'>

    <link rel='stylesheet' href='../../assets/unsemantic-grid-base.css'>
    <link rel='stylesheet' href='../../assets/unsemantic-grid-desktop.css'>
    <link rel='stylesheet' href='../../assets/bootstrap-btn.css'>
    <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'>

    <link rel='stylesheet' href='../../assets/fonts/YanoneKaffeesatz/YanoneKaffeesatz.css'>
    <link rel='stylesheet' href='../../assets/fonts/DroidSerif/DroidSerif.css'>
    <link rel='stylesheet' href='../../assets/fonts/UbuntuMono/UbuntuMono.css'>

    <style>
      body {
        font-family: 'Droid Serif';
      }

      h1, h2, h3, h4 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }

      h4 {
        font-size: 30px;
        margin: 1em 0;
      }

      h1 strong, h2 strong, h3 strong, h4 strong, h5 strong, h6 strong {
        text-decoration: underline;
      }

      .image-header h2, .image-header h3, .image-header h4, .image-header h5 .image-header h6 {
        display: none;
      }

      strong em {
        text-decoration: underline;
      }

      center {
        margin: 1em 0;
      }

      .remark-code, .remark-inline-code {
        font-family: 'Ubuntu Mono';
      }

      .remark-inline-code {
        padding: 0 2px;
        background-color: #eee;
        color: indianred;
        border-radius: 3px;
        border: thin solid #dddddd;
      }

      .remark-slide-content img {
        max-width: 100%;
      }

      .remark-slide-content p:first-child, .remark-slide-content ul:first-child {
        margin-top: 0;
      }

      .container {
        clear: both;
      }

      ul li {
        margin-top: 0.4em;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      table th, td {
        padding: 0.2em 0.4em;
      }

      table tbody th, td {
        border-top: 1px solid #c0c0c0;
      }

      pre:first-child, blockquote:first-child {
        margin-top: 0;
      }

      blockquote {
        font-style: italic;
        border-left: 5px solid khaki;
        margin-left: 0;
        padding-left: 35px;
      }

      .center blockquote {
        margin-right: 0;
        padding-right: 35px;
        border-right: 5px solid khaki;
      }

      #slide-logo {
        position: absolute;
        top: 0;
        left: 0;
      }

      #slide-logo img {
        height: 60px;
      }

      .breadcrumbs {
        position: absolute;
        top: 15px;
        left: 5.333em;
        font-size: 15px;
        color: #c0c0c0;
      }

      .breadcrumbs a {
        color: #c0c0c0;
        text-decoration: none;
      }

      .breadcrumbs a:hover {
        text-decoration: underline;
      }

      .center.middle .breadcrumbs {
        display: none;
      }

      #slide-links {
        position: absolute;
        top: 15px;
        right: 15px;
        font-size: 15px;
        text-align: right;
      }

      .w5 { width: 5%; }
      .w10 { width: 10%; }
      .w15 { width: 15%; }
      .w20 { width: 20%; }
      .w30 { width: 30%; }
      .w35 { width: 35%; }
      .w40 { width: 40%; }
      .w45 { width: 45%; }
      .w50 { width: 50%; }
      .w55 { width: 55%; }
      .w60 { width: 60%; }
      .w65 { width: 65%; }
      .w70 { width: 70%; }
      .w75 { width: 75%; }
      .w80 { width: 80%; }
      .w85 { width: 85%; }
      .w90 { width: 90%; }
      .w95 { width: 95%; }
      .w100 { width: 100%; }

      .x2 { font-size: 2em; }
      .x3 { font-size: 3em; }
      .x4 { font-size: 4em; }

      .compact-table table td {
        font-size: 0.9em;
      }

      .shadow {
        box-shadow: lightgrey 0 0 3px;
      }
      p.shadow { width: 100%; }
    </style>
  </head>
  <body>

    <!-- Slides top-left logo -->
    <span id='slide-logo' style='display:none;'><a href='http://www.heig-vd.ch/'><img src='../../assets/heig.png' /></a></span>

    <!-- Slides top-right links -->
    <div id='slide-links' style='display:none;'>
      <!-- GitHub link -->
      <a href='https://github.com/MediaComem/comem-webdev/tree/6400e03f2f424376b74326418eaa51a264cc997b/subjects/apidoc/'><img src='../../assets/github.svg' width='24' height='24' alt='Source code' title='GitHub' /></a>
      <!-- Home link -->
      <a class='home-link' href='https://mediacomem.github.io/comem-webdev-docs/'><img src='../../assets/home.svg' width='24' height='24' alt='Home' title='Home' /></a>
    </div>

    <!-- Remark slides -->
    <textarea id='source'>
# apiDoc

Learn to generate HTML documentation for your RESTful API from annotations in your source code, using [apiDoc][apidoc].

**You will need**

* [Node.js][node] 6+

**Recommended reading**

* [RESTful APIs](../rest/)
* [npm](../npm/)





---
## What to do

.breadcrumbs[<a href="#1">apiDoc</a>]

Put comments such as this in your code:

```js
/**
 * @api {get} /users/:id Request a user's information
 * @apiName GetUser
 * @apiGroup User
 *
 * @apiParam {Number} id Unique identifier of the user
 *
 * @apiSuccess {String} firstName First name of the user
 * @apiSuccess {String} lastName  Last name of the user
 */
```



---
### Install and run apiDoc

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#2">What to do</a>]

[apiDoc][apidoc] is an npm package.
Install it globally with:

```bash
$> npm install -g apidoc
```

Move into your project's directory and run apiDoc with two options:

* The `-i` option should be followed by the **directory containing your documented API routes**
* The `-o` option should be followed by the **directory where you want the generated documentation to be saved**

```bash
$> cd /path/to/projects/my-project
$> apidoc -i `routes` -o `docs`
warn: Please create an apidoc.json configuration file.
info: Done.
```

Open the generated `docs/index.html` file in your browser.



---
### The generated documentation

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#2">What to do</a>]

<p class='center'><img src='images/generated.png' class='w80' /></p>



---
### Using a configuration file

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#2">What to do</a>]

It's good practice to create an `apidoc.json` file in your project's directory to configure some documentation properties:

```json
{
  "name": "My project",
  "version": "1.0.0",
  "description": "It is awesome",
  "title": "My project",
  "url" : "https://example.com"
}
```

This will get rid of the `Please create an apidoc.json configuration file` warning when you run apiDoc.



---
### Using apiDoc as a development dependency

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#2">What to do</a>]

You can also install and run apiDoc as a development dependency:

```bash
$> npm install --save-dev apidoc
```

Add an `apidoc` script to your `package.json` file:

```json
{
  "name": "my-project",
  "scripts": {
*   "apidoc": "apidoc -i routes -o docs",
    "start": "..."
  },
  ...
}
```

You and your teammates can now generate the documentation this way,
without having to install the module globally on each machine:

```bash
$> npm run apidoc
```



---
## How it works

.breadcrumbs[<a href="#1">apiDoc</a>]

The main annotation of apiDoc is:

```
  @api {get} /path Short description
```

As long as you have it in a comment, apiDoc will parse that comment and include it into the generated documentation.



---
### Structural annotations

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#7">How it works</a>]

The following annotations are used to **organize** your documentation and configure the **left-side menu**:

Annotation    | Purpose
:---          | :---
`@apiName`    | The name under which the comment block will appear in the left-side menu
`@apiGroup`   | All comment blocks in the same group will be grouped together in the left-side menu, with the group name as a header
`@apiDefine`  | Defines a reusable documentation block that you can included into other comments with `@apiUse`
`@apiUse`     | Re-use the annotations from another documentation block defined with `@apiDefine`



---
### Descriptive annotations

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#7">How it works</a>]

The following annotations describe how your **API operations** work and the contents of the **HTTP requests and responses**:

Annotation           | Purpose
:---                 | :---
`@apiDescription`    | Detailed multi-line description of the operation
`@apiHeader`         | HTTP header description
`@apiHeaderExample`  | HTTP header example
`@apiParam`          | Request parameter (e.g. URL path, URL query, JSON property)
`@apiParamExample`   | Request parameter example
`@apiExample`        | Full HTTP request example
`@apiSuccess`        | Response parameter (e.g. JSON property)
`@apiSuccessExample` | Successful HTTP response example
`@apiError`          | Possible error for that operation
`@apiErrorExample`   | Error HTTP response example
`@apiVersion` | The version of your documentation block (useful if several versions are active in parallel)



---
### Documenting request parameters

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#7">How it works</a>]

The `@apiParam` annotation is a generic annotation to document any kind of request parameter.
You can group parameters together by specifying a **category in parentheses**:

```js
/**
 * @apiParam `(URL path parameters)` {String} id The movie's unique identifier
 * @apiParam `(URL query parameters)` {Number} page The page to retrieve
 * @apiParam `(Request body)` {String} title The movie's title
 * @apiParam `(Request body)` {Number} rating The movie's rating
 */
```

This will produce three parameter tables in the generated documentation:

* A table with the `URL path parameters` header and the first parameter
* A table with the `URL query parameters` header and the second parameter
* A table with the `Request body` header and the last two parameters



---
#### Request parameter constraints

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#7">How it works</a> > <a href="#10">Documenting request parameters</a>]

You can document **validation constraints** on request parameters:

```js
/**
 * @apiParam (URL query parameters) `{Number{1..}}` `[`page`]` The page to retrieve
 * @apiParam (Request body) `{String{3..50}}` title The movie's title
 * @apiParam (Request body) `{Number{0..10}}` `[`rating`]` The movie's rating
 * @apiParam (Request body) `{String="male","female"}` gender The person's gender
 */
```

* Parameter names surrounded with brackets `[]` are **optional**
* **Length constraints** can be specified as a range (e.g. `Number{1..}` means 1 or greater, `String{3..50}` means between 3 an 50 characters long)
* **Enumeration constraints** can be specified as comma-separated values (e.g. `String="male","female"`)



---
### Reusing annotations

.breadcrumbs[<a href="#1">apiDoc</a> > <a href="#7">How it works</a>]

Let's say you have several API operations where the request body has the same request parameters.
You can define those **once** in an `@apiDefine` block:

```js
/**
 * `@apiDefine PersonInRequestBody`
 * @apiParam (Request body) {String{3..30}} name The person's name
 * @apiParam (Request body) {String="male,female"} gender The person's gender
 * @apiParam (Request body) {String} [birthDate] The person's birth date
 */
```

And **reuse** these annotations in other blocks with `@apiUse`:

.grid-50[

```js
/**
 * @api {post} /api/people
 * `@apiUse PersonInRequestBody`
 * ...
 */
```


]
.grid-50[

```js
/**
 * @api {put} /api/people/:id
 * `@apiUse PersonInRequestBody`
 * ...
 */
```


]
.container[

This works for most apiDoc annotations, not just request parameters.




]
---
## Resources

.breadcrumbs[<a href="#1">apiDoc</a>]

* [apiDoc documentation][apidoc]



[apidoc]: http://apidocjs.com
[apidoc-param]: http://apidocjs.com/#param-api-param
[node]: https://nodejs.org/

    </textarea>

    <script src='../../assets/remark.min.js'></script>
    <script src='../../assets/jquery-3.1.1.slim.min.js'></script>
    <script src='../../assets/uri-1.18.7.js'></script>

    <script>
      var remarkOptions = {"highlightLines":true,"highlightSpans":true,"countIncrementalSlides":false};
      var slideshow = remark.create(remarkOptions);

      $('#slide-links .home-link').each(function() {
        var $a = $(this);

        var currentUri = URI(window.location.href);
        var home = currentUri.search(true).home

        if (typeof(home) == 'string' && home.match(/^[a-z0-9\-\_\.]+\/[a-z0-9\-\_\.]+(?:#.*)?$/i)) {
          $a.attr('href', 'https://github.com/' + home);
        } else if (typeof(home) == 'string') {
          $a.attr('href', home);
        } else if (currentUri.hostname() == 'localhost') {
          $a.attr('href', currentUri.path('').hash('').toString());
        }
      });

      var slides = $('.remark-slide-content');

      // Remove logo from body and add it to each slide
      $('#slide-logo').remove().prependTo(slides).show();

      // Remove links from body and add them to each slide
      $('#slide-links').remove().prependTo(slides).show();

      // Make all external links open a new window
      $('a[href]').not('.home-link').not('[href^="#"]').attr('target', '_blank');
    </script>
  </body>
</html>
